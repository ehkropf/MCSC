%% cracks example (bounded)
clear


%%
P = intpolys(...
  polygon([5i; -3+5i; -3-5i; 3-5i; 3+5i]),...
  polygon([1.5+1.7i; 2+2.6i; 1.3+3.6i; 1.7+4.4i;...
           1.3+3.6i; 2+2.6i]),...
  polygon([-1.3+1i; -1.3+4i]),...
  polygon([-1.7-0.5i; -1.7-3.9i]),...
  polygon([-0.5-1.7i; -0.5-3.8i]),...
  polygon([1.9-0.07i; 1.9-2.9i]) ...
);

fixed = [0 0];

Cg = circdomain(...
  { 0 1 [ 0; 3*pi/20; 4*pi/5; 23*pi/20; 9*pi/5 ] },...
  { 0.66-0.36i 0.13 [ pi; 3*pi/2; 9*pi/5; 2*pi; 5*pi/2; 27*pi/10 ] },...
  { 0.55+0.31i 0.16 [ pi; 2*pi ] },...
  { -0.45+0.47i 0.18 [ 0; pi ] },...
  { -0.54+0.1i 0.09 [ 2*pi; 3*pi ] },...
  { -0.36-0.51i 0.18 [ 2*pi; 3*pi ] } ...
);

%%
opts = intmapopts;
opts.N = 5;
opts.tolerance = 1e-6;
opts.monitor = 1;

C = circdomain(Cg);
f = intmap(P, fixed, C ,opts);

% plot(f)
